# Architecture Visual Summary
## Quick Visual Reference

## ğŸ—ï¸ Complete System Architecture

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ğŸŒ INTERNET       â”‚
                    â”‚   (Global Users)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ HTTPS
                               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     CLOUDFRONT CDN (Global Edge)     â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚  Edge Locations Worldwide      â”‚  â”‚
        â”‚  â”‚  â€¢ US East/West                â”‚  â”‚
        â”‚  â”‚  â€¢ Europe                      â”‚  â”‚
        â”‚  â”‚  â€¢ Asia Pacific                 â”‚  â”‚
        â”‚  â”‚  â€¢ Automatic routing            â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   VERCEL      â”‚      â”‚   AWS S3      â”‚
â”‚  (Frontend)   â”‚      â”‚  (Media)      â”‚
â”‚               â”‚      â”‚               â”‚
â”‚  Next.js App  â”‚      â”‚  Images       â”‚
â”‚  API Routes   â”‚      â”‚  Videos       â”‚
â”‚  Edge Cache   â”‚      â”‚  Documents    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                      â”‚
        â”‚                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   SUPABASE    â”‚
        â”‚  (Database)   â”‚
        â”‚               â”‚
        â”‚  PostgreSQL   â”‚
        â”‚  Auth (opt)   â”‚
        â”‚  Realtime     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow: Viewing Content

```
USER REQUEST
     â”‚
     â”‚ GET /events/chinese-new-year
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CloudFront CDNâ”‚  â† Check cache first
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Cache miss? Continue
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel App     â”‚  â† Next.js renders page
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ API: /api/events/:id
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Supabase DB    â”‚  â† Query database
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Returns: { image_url: "s3://..." }
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel API    â”‚  â† Transform to CloudFront URL
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Response: { image_url: "https://cdn.../image.webp" }
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CloudFront     â”‚  â† Cache response (5-15 min)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Return to user
         â–¼
    USER BROWSER
```

---

## ğŸ“¸ Media Flow: Image Request

```
USER BROWSER
     â”‚
     â”‚ GET /images/events/cny-2024.webp
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CloudFront CDN â”‚  â† Check edge cache
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Cache hit? Return immediately (fast!)
         â”‚ Cache miss? Continue
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AWS S3 Bucket  â”‚  â† Fetch from origin
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Return image
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CloudFront     â”‚  â† Cache for 1 year
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Compress & deliver
         â–¼
    USER BROWSER
```

---

## ğŸ“¤ Upload Flow: Admin Uploads Media

```
ADMIN BROWSER
     â”‚
     â”‚ POST /api/upload (FormData: file)
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel API     â”‚  â† Validate file
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Optional: Optimize with Sharp
         â”‚ - Resize
         â”‚ - Convert to WebP
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AWS S3        â”‚  â† Upload file
â”‚  PUT Object      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Save: images/events/2024/uuid-filename.webp
         â”‚ Return: S3 key
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Supabase DB    â”‚  â† Save metadata
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ INSERT INTO media_gallery
         â”‚ (s3_key, s3_url, event_id)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel API     â”‚  â† Return CloudFront URL
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Response: { url: "https://cdn.../image.webp" }
         â–¼
    ADMIN BROWSER
```

---

## ğŸ’¾ Storage Structure

```
S3 BUCKET: hoadao-media
â”‚
â”œâ”€â”€ ğŸ“ images/
â”‚   â”œâ”€â”€ ğŸ“ events/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ 2024/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ 01-january/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ chinese-new-year/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ hero.webp
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ ğŸ“ gallery/
â”‚   â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ img-001.webp
â”‚   â”‚   â”‚   â”‚       â”‚   â””â”€â”€ img-002.webp
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ ğŸ“ thumbnails/
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ 02-february/
â”‚   â”‚   â””â”€â”€ ğŸ“ 2023/ (archived)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ team/
â”‚   â”‚   â”œâ”€â”€ member-001.webp
â”‚   â”‚   â””â”€â”€ member-002.webp
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ gallery/
â”‚
â”œâ”€â”€ ğŸ“ videos/
â”‚   â”œâ”€â”€ ğŸ“ performances/
â”‚   â”‚   â””â”€â”€ ğŸ“ 2024/
â”‚   â”‚       â””â”€â”€ cny-2024-performance.mp4
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ highlights/
â”‚
â””â”€â”€ ğŸ“ documents/ (if needed)
```

---

## ğŸ”„ Component Interactions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Next.js  â”‚
â”‚  Frontend  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”œâ”€â”€â”€ API Calls â”€â”€â”€â”
      â”‚                 â”‚
      â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase â”‚    â”‚   S3     â”‚
â”‚ Database â”‚    â”‚ Storage  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚                â”‚
      â”‚                â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  CloudFront  â”‚
      â”‚     CDN      â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’° Cost Visualization

### Monthly Cost Breakdown (1-5GB/day)

```
Total: $55.80/month
â”‚
â”œâ”€â”€ Vercel Pro:     $20.00 (36%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â”œâ”€â”€ Supabase Pro:   $25.00 (45%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â”œâ”€â”€ AWS S3:         $2.30  (4%)  â–ˆ
â””â”€â”€ CloudFront:     $8.50  (15%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
```

### Monthly Cost Breakdown (10GB/day)

```
Total: $77.40/month
â”‚
â”œâ”€â”€ Vercel Pro:     $20.00 (26%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â”œâ”€â”€ Supabase Pro:   $25.00 (33%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â”œâ”€â”€ AWS S3:         $6.90  (9%)  â–ˆâ–ˆâ–ˆâ–ˆ
â””â”€â”€ CloudFront:     $25.50 (32%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
```

---

## ğŸš€ Deployment Flow

```
Developer
    â”‚
    â”‚ git push
    â–¼
GitHub
    â”‚
    â”‚ Webhook
    â–¼
Vercel CI/CD
    â”‚
    â”œâ”€â”€ Install dependencies
    â”œâ”€â”€ Build Next.js app
    â”œâ”€â”€ Run tests
    â””â”€â”€ Deploy
         â”‚
         â”œâ”€â”€ Preview (PR branches)
         â””â”€â”€ Production (main branch)
```

---

## ğŸ”’ Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: CloudFront            â”‚
â”‚  â€¢ DDoS Protection              â”‚
â”‚  â€¢ SSL/TLS                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 2: Vercel                â”‚
â”‚  â€¢ Environment Variables         â”‚
â”‚  â€¢ Rate Limiting                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 3: S3                    â”‚
â”‚  â€¢ Private Bucket                â”‚
â”‚  â€¢ IAM Policies                 â”‚
â”‚  â€¢ Encryption at Rest           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 4: Supabase              â”‚
â”‚  â€¢ Row Level Security           â”‚
â”‚  â€¢ SSL Connections              â”‚
â”‚  â€¢ API Key Authentication       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Scaling Path

```
Phase 1: MVP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Free Tier       â”‚
â”‚ $0/month        â”‚
â”‚ 0-1GB/day       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
Phase 2: Growth
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Production      â”‚
â”‚ $55-82/month    â”‚
â”‚ 1-10GB/day      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
Phase 3: Scale
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Optimized       â”‚
â”‚ $100-200/month  â”‚
â”‚ 10-50GB/day     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
Phase 4: Large Scale
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Full AWS        â”‚
â”‚ $180-300/month  â”‚
â”‚ 50GB+/day       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Key Architecture Decisions

### âœ… Why This Architecture?

1. **Vercel**: Fastest deployment, best DX, automatic scaling
2. **Supabase**: Includes auth, real-time, cheaper than RDS
3. **S3**: 89% cheaper than Cloudinary, full control
4. **CloudFront**: Global CDN, automatic caching
5. **Next.js Image**: Free optimization, no Cloudinary needed

### ğŸ’¡ Optimization Strategies

- **S3 Lifecycle**: Auto-move to cheaper storage classes
- **CloudFront Caching**: Reduce origin requests by 80-90%
- **Next.js Image**: Automatic WebP conversion, lazy loading
- **Vercel Edge**: Global edge caching for API responses

---

*Quick visual reference for the complete architecture.*  
*See ARCHITECTURE_DESIGN.md for detailed documentation.*  
*Last updated: [Date]*


